<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ape-stract Art Gallery</title>
    <style>
        @font-face {
            font-family: 'CustomFont';
            src: url('/content/b3af17d23c17f604ec00251e4333cd40fa6230ed7386d685d63d3acce9516f33i0') format('truetype');
            font-weight: normal;
            font-style: normal;
        }
        body { 
            margin: 0; 
            overflow: hidden; 
            cursor: url('/content/0798bf75ab07fcdf153c13fc07ef381916a010ebe5d5729564aef3dd0aac4a54i0'), auto; /* Custom cursor */
        }

        canvas { display: block; }

        #modal {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.8);
            display: flex;
            justify-content: center;
            align-items: center;
            color: #e61cf4;
            z-index: 200;
            font-family: CustomFont, sans-serif;
        }
        #modalContent {
            text-align: center;
            background-image: url('/content/ba71544f3a6431f4a83375bdcecf4f714a25dafb82920ba79bab638f84968230i0');
            background-size: cover;
            background-position: center;
            background-repeat: no-repeat;
            padding: 69px;
            border-radius: 30px;
        }
        #okButton {
            margin-top: 20px;
            padding: 10px 20px;
            font-size: 16px;
            background-color: #2700ff;
            color: rgb(255, 255, 0);
            border: none;
            border-radius: 5px;
            cursor: url('/content/0798bf75ab07fcdf153c13fc07ef381916a010ebe5d5729564aef3dd0aac4a54i0'), auto;
            font-family: CustomFont, sans-serif;
        }
        #topButtons {
            position: absolute;
            top: 10px;
            left: 10px;
            z-index: 150;
            display: flex;
            gap: 10px;
            font-family: CustomFont, sans-serif;
        }
        .topButton {
            padding: 10px 20px;
            font-size: 16px;
            background-color: #00ff3dad;
            color: #2700ff;
            border: none;
            border-radius: 5px;
            cursor: url('/content/0798bf75ab07fcdf153c13fc07ef381916a010ebe5d5729564aef3dd0aac4a54i0'), auto;
            font-family: CustomFont, sans-serif;
        }
        #controls {
            position: absolute;
            bottom: 20px;
            left: 20px;
            z-index: 100;
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        .button {
            width: 60px;
            height: 60px;
            margin: 10px;
            border-radius: 50%;
            background-color: #43415d;
            color: rgb(0, 0, 0);
            font-size: 24px;
            text-align: center;
            line-height: 60px;
            user-select: none;
            cursor: url('/content/0798bf75ab07fcdf153c13fc07ef381916a010ebe5d5729564aef3dd0aac4a54i0'), auto;
        }
        #joystick {
            position: absolute;
            bottom: 20px;
            right: 20px;
            width: 100px;
            height: 100px;
            border-radius: 50%;
            background-color: #43415d;
            touch-action: none;
            z-index: 100;
        }
        #joystickInner {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background-color: #ccc;
            position: relative;
            top: 25%;
            left: 25%;
        }
        #horizontalControls {
            display: flex;
            justify-content: center;
            align-items: center;
        }
    </style>
</head>
<body>

<div id="modal">
    <div id="modalContent">
        <p>Ape-stract Art Gallery</p>
        <p>Click and drag to Monkey Around 
        Using ASWD or arrow keys</p>
        <p>Mobile - Follow on screen instructions</p>
        <p>Press refresh to see new images</p>
        <p>Back to go back</p>
        <p>Click on images to view in Marketplace</p>
        <button id="okButton">OK</button>
    </div>
</div>

<div id="topButtons">
    <button id="backButton" class="topButton">Back</button>
    <button id="refreshButton" class="topButton">Refresh</button>
</div>

<div id="controls">
    <div class="button" id="up">↑</div>
    <div id="horizontalControls">
        <div class="button" id="left">←</div>
        <div class="button" id="down">↓</div>
        <div class="button" id="right">→</div>
    </div>
</div>

<div id="joystick">
    <div id="joystickInner"></div>
</div>

<script src="/content/f8d6d9594ff93cb4190cfa81d877b81b59b0d2acd975685fdd12efd0452bd190i0"></script>

<script>
    const inscriptionIds = [
        "5c4e39b917b700ce2c9e4840130c825a8365e8b6ff516e82f7680f194f39ba78i0",
        "6b1ad2788d6933118dce167f5b59eaefea0b96cf26a893ee647c26849523e7d3i0",
        "c724722bdfbc159c9162dae0acc1e8eabb26cc08ea7b831d2fb9be02094a80a7i0",
        "2f007b97ae7b2d0543c28a421ec5f1072fba80eb7d38857eb39ea70c6998497bi0",
        "4f7823c3abd377bd7bcabcbac42d5a0c8045261666e8442852c3f19fd93bf77ai0",
        "8a24dcf6baac2f864ff8e7bfebefe0c143c247b6d54ce2bbae62cf9cf7fd66c7i0",
        "e9e5970813c24b44c47b9b1db5d04492705e9a83c5c751c4f2b8b9ead250ce5di0",
        "a3610fd6693572c714f9ca8e1a7eb5e84338419dee41e7e5a9d53b3e15015309i0",
        "0ab9613732ec2193ed498370b4514ee17cbae4bea98e0deedb7681f048573aeei0",
        "a4a089e9c26bf204c60f3a7d8050bb7319f73616d4e2e92fcb61d1514ce07ab9i0",
        "52efeec3b4342bf0df8ee7e6e692b86aad74e81189cc77a28aee6c95e1fd9fbei0",
        "600cd2e6b651ea3098f3c876469050b017c9504f19b3826fbc9fcba134dbfb76i0",
        "ac02922865fd6fa2b8d5148bbef4fb02216cfdd996f1d237e921c10d6b6afd6ai0",
        "685c5cafaea639c9d101505808a618350989ea0af8035c8c441595a9aefb8418i0",
        "89921cb1ec15eedb575ab903b9ddcd0abf193bbe091c63309d248fa052316900i0",
        "bee66f99ccc26a0fef2ac36db6784e528d98a9837d43e8cc6b669321eecf95d3i0",
        "bc7754b217686109fa44c41b769926bc8ce9d0bb70d961f6033146dd9909c8c9i0",
        "fd0937b41d5d9f380d9e4e7c10a5954f18037f4da10fab0331aa6ee2a9df5886i0",
        "3e7b4de7e495bab2f04fa6cc3b65fc74355466e4ff12edf40052ee128d20dc0ai0",
        "cc4518a394115bea744de3ce854b2ecb24c15df873af02d06e1aee91ba400f19i0",
        "e87ca5426b5332362794c387c14bad6958c115673d1ecfe7da9b04c4177c4342i0",
        "2f999659421ea976a60fed9d48e3b94eb825884162160685ee84353d66482088i0",
        "1c3b333001bdc1cdb7ef084a786c5928bb23f0c61808f5de4b601b95f689edf5i0",
        "2c481fac302c7f2ccd3fb75566f8248cbd02177db9e7a3110a89a4d7ca54ca52i0",
        "34eda2ce303b6141f56522f663b4fd572cc9b92759ceb9965f901df13b799f3di0",
        "edc74267c684851b037746fdf4c9f10a57b561420d166e69721d083104419816i0",
        "c64c4eafb45764161a760bdaf54d0aba4db95bfa399fc12c0b4805b5f56e7792i0",
        "d6094468aa8c3723caa2e4ba1cacad6200522d420592ef27e062d8bb7e9df200i0",
        "74a51736a9594114ffbd4dcf686610d14edc53b2b373b9b72e334fbd23d39348i0",
        "cb6a09524cc58a94d97d749526eab2fbae912625fd82a2446a44d237aad6086di0",
        "4b6efd181b19652abc1aaff8479126582fe2d49ca5c1b4bc0e55101547b7ff71i0",
        "23356ceba15075925e78778d73fe5b19438467ca7ef7f39f090f0d8c1599b398i0",
        "c0cb4f56e8d69064b780d78665664a6cb6478310e471787fc9068a213a00ad24i0",
        "595f12dd7e017c71f3b84caa4de65b6a80204bd03b4a64422474f6f42e96428ci0",
        "ae96de7cc7027ce79a97e45ac1834204c0eeaffc5d17d744fd0677b040081e4bi0",
        "2d1990dae84f0979adf6ae2c521d0a810a01d0c5dfe3280b91c312e03d163012i0",
        "04f6ef0edebddbbbe3dfa41d15c86851ea1bb7c864c9573181299c59c4b1641bi0",
        "6efb6589d39de781e46186a9cc4ac20d33baaba2e1dcfd4406658ae19371405di0",
        "47fe8bdfe87e3703dca48a76226e84f88f198e2ceec1de3a5705a5d69767ea85i0",
        "5b1630bd4e91d5615c31b70caf3d5a738709365c82d165ef3833a3c238d0eadai0",
        "ba71544f3a6431f4a83375bdcecf4f714a25dafb82920ba79bab638f84968230i0",
        "2c0c90f284085fbbbb9e60a175425c71661f5099cddabec02f14cabf2cf77961i0",
        "089884df926daa1fc35db7a7a050cfe922e1ef38613657209b04d9b3232885b1i0",
        "b00ac3ef66464124f6f06c2354d1fc2d71c764d9704ac817fbe785b24c919d46i0",
        "8bb6b4b403c1cc0b7b9f484a95ecc551ac36dbab1be08169047c736facdad85ei0",
        "89fbbc4d5b02f74807d3bacde354c147b52520d4276dd4c466c65b61ad79eaa9i0",
        "6095266438209ce49150d8706d67eeb4616593e1d123b4a73c3d73c979a2a6edi0",
        "80953df76657ee0529385ab50ccd6b4dd1c9cfb24609bc37d5ae08721a15d6c2i0",
        "82410fcde9e2abab74749fc02e9b881b5052945494891f6d3c8a10fc96566af2i0",
        "8031d707a31718dfdeab65d56218c918df524b427540a75462da09b3a3dc4837i0",
        "e6d417c1e4d3c098c4ad126eca88c583678ae5f967c82be646d215312a89cc80i0",
        "5eb2f086b9c69d3d44a51bb31576ca737ddf30c67fedeb2cb2da5cba6e7870ebi0",
        "775b9b8b269d8b089c14b04441454d6ebe493a3e1fb53fdee3b6b4471953d9e5i0",
        "b9828dfb61daf2185942075a0fd64e4a0a2baa7e48cf38cb8e6d87d2fa9222d0i0",
        "6fda211a9a7acd581ae249bff517f44908507e0f08a1812c590c1befa8d0c24fi0",
        "285bdb1796f7f8e27aa63ea3af81560c2058a4b0214c1c2171162d3a931d6921i0",
        "ffd442b186ad08658ae85c61bbd92f4da7f367d775c21158c4db97337cadbfbai0",
        "1b6cfaf8886eb0d68e528d4b18f187aab1451cd2356c9cf2a86fd86ff70c7e17i0",
        "b02ec55e8191538d8c7bb1e244a3f6eed2b6de07f2cae010517fcdbc8caa81a9i0",
        "31fe5aaad383bc255cacf838d65d8dc38217175ee9e1d3a29c801d829f83305bi0",
        "800733a871382d4d5333d0d125d17cdc1f92753ba17159eed10d21ac0fd4db21i0",
        "344c99321f6f9a2e690d66ae647a89ebd848b68d8924fe8c8ca617362f7d8ae6i0",
        "db8abaa6fcd96706b07baaee57688af0cf22f6fed0c91bfa54b501ff610d6ff4i0",
        "8a0b02cfbf4982f61785bda49bd862c8e9925a3a0c8f0441601de99164a7a92ai0",
        "4fbf921363ab50d9e0fe1f870056fade15a3072d4b6f99f33bd64453d38d9a93i0",
        "54bf0cc9662c0d3d3b2495bfab5fdeb8394ce1d3e68318d76ca1d0f303d0b3f2i0",
        "151f58668cd9370801b675d22f8552dfa9c156120b118fddaa9229f45d99f65fi0",
        "3f743b77dca25268499cd90ab074754f50629069a4381cf65c2fc6806426fdaci0",
        "e9cc7f4f0ee08bbc9b4ee86a4a039e7cd08702bbcf7984f493bfc5f962d77cd7i0",
        "befcc99ff6f2f5a1cdefa2bfbd8a2f7d7ce3ca9fdd2e99b5b08b6eac116312e5i0",
        "222fd177bfeb0cd5acc06d2af0826d264d48987b70630fbc904cadf984b2c78fi0",
        "140c9893dc8d2a0c07e1b32a0cd52f9398754ccd937e1affe962f6a130fb4849i0",
        "6eab24c3edb0fabf6fff9a37e97bcd3fce5ed17854edb635833e993aa9d84c3di0",
        "d60bbbbb12a0ec4e44f914b812cdaf5798b979061161c4c4f206fbe0ba946774i0",
        "a68e065c2824db4d9e8d796785bb6bfcba7ea6d129cced823f62a987e439a0b6i0",
        "6a84fbd23956f525d93b50c766b1de1e42aaf2815923025bb02b0000cd16fa80i0",
        "3ebfd9afd33aaab43d7cbaa160aa57596355a4fc4734477ac3132c1828728e27i0",
        "275efd141108175f279bf469715ca212b5cea97426d6ae336aca64a8cb3e03cai0",
        "31af57277f6653fc02653ceb21d3393349336c7b032b06681b68710f7519111ai0",
        "126d0380dfc22329db522fb8a14fa907c49fe72af1da53e9d3e171439d1cb163i0",
        "0f3938d7908941e6a572d840877656faedb362c85b33a0c15482376b4998ffcai0",
        "b3f54e6d28b0480c77df91d29feb88e3cd66ffb373d558ed65f8b456717b588di0",
        "9e7f4d6e2ede2de81bfeebfbee7ea6d70be6cc9bf0a3f013850be7350400ac13i0",
        "c50bda99de7ff997c01646131a058f26bc305bbb31d481670d7d0786bf6c36a0i0",
        "6dde02ae7efb4d62e96a4a6eb7e18569e263a4ee586e8882666319b16ed44951i0",
        "daca656f174630aa4d34698d7cf5c6c3987d1d2306ee9d0a2cec600dcee7e16fi0",
        "2d147592e8d4bee5d36362bf5384265e078ea4715efbb1ac73605554f36df559i0",
        "153605ac3cc6cf15253439b9b5c8018fba6e252cb4e5629a7d3bb4ea8ac09e5bi0",
        "876817ededb196c93845e84badeaf69534ac6b878ec01b2b916165e70f0f51f3i0",
        "81c904bf39076a58e7f7c9eea178ec760ab2b3fcd7e679384bd72cfc157a5f7fi0",
        "9d949306eeccab6b997f0d5b6d18595d846edb81e165cb859a4036aa63b2f9f5i0",
        "1d92ad4a1c2b9e093e7f8c41852c757b323941378eae6f3a81cdf01ce3ee5703i0",
        "0f0b0d91c6c0b0901182fc5a5c55bcc28634cda64a10592496ab9273ebd53c09i0",
        "cd5a793184453ce44b713adb13aebaa85a3102be86f04582d7f31851a31d9507i0",
        "e0b590b209c4f0a34e5e4b24f0a3b91d4c6285bcda010bcbb434f21bae31ffafi0",
        "23fe0e3e85cee371d81d3b2ff0097f5c2c88f6241447ff3e3d7036935483135fi0",
        "27c99b960643d2fa3c1ccee70862615a38d462ce565d20039a35c785f2c02cc9i0",
        "baac0b26b246b7e3f856572a491ded1c1c2e834ab4c824e932b9420ae8b45c31i0",
        "ec3fa1507368b4439f86b047ecd59eb4163b6d836602508d0f474cd983cdd3cbi0",
        "c0a060de67dce99fe1fada13cdb69d132b51bd1df83706df0891a902c8c50347i0"
    ];

    let camera, scene, renderer;
    let raycaster, mouse, isDragging = false;
    let moveForward = false, moveBackward = false, moveLeft = false, moveRight = false;
    const velocity = new THREE.Vector3();
    const speed = 0.09;  
    let currentImageIndex = 0;
    let imageMeshes = [];

    init();
    animate();

    function init() {
        camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
        camera.position.set(0, 2, 0); 

        scene = new THREE.Scene();
        renderer = new THREE.WebGLRenderer({ antialias: true });
        renderer.setSize(window.innerWidth, window.innerHeight);
        document.body.appendChild(renderer.domElement);

        const textureLoader = new THREE.TextureLoader();

        // Add lighting to ensure proper rendering of materials
        const ambientLight = new THREE.AmbientLight(0xffffff, 0.7);  // Softer overall light
        scene.add(ambientLight);

        const directionalLight = new THREE.DirectionalLight(0xffffff, 2);
        directionalLight.position.set(10, 10, 10);
        scene.add(directionalLight);

        // Add additional directional light focused on the floor
	const floorLight = new THREE.DirectionalLight(0xffffff, 1);
	floorLight.position.set(0, 10, 0);  // Position it above the floor
	floorLight.target.position.set(0, 0, 0);  // Target the floor center
	scene.add(floorLight);
	scene.add(floorLight.target);

        // Load the floor texture
        const floorTexture = textureLoader.load('/content/bbf7387a7280dd3f31c0d6098f2ecff74b03f5d32e6e2acd9fed3b0d56787aa0i0');
        const floorMaterial = new THREE.MeshStandardMaterial({
            map: floorTexture,
            roughness: 0.2, // Lower roughness for shinier surface
            metalness: 0.8 // Increase metalness for a more reflective floor
        });
        const floorGeometry = new THREE.PlaneGeometry(500, 500);
        const floor = new THREE.Mesh(floorGeometry, floorMaterial);
        floor.rotation.x = -Math.PI / 2;
        floor.position.y = 0;
        scene.add(floor);

        // Load ceiling texture
        const ceilingTexture = textureLoader.load('/content/86887e3ff26e6764f2f501ad570e4b10f594460273d056b4103d74fdc2fa68dfi0');

        floorTexture.wrapS = floorTexture.wrapT = THREE.RepeatWrapping;
        floorTexture.repeat.set(10, 10);  // Adjust these values to fit the texture properly across the floor

        const ceilingMaterial = new THREE.MeshStandardMaterial({
            map: ceilingTexture,
            roughness: 0.8,
            metalness: 0.2
        });
        const ceilingGeometry = new THREE.PlaneGeometry(500, 500);
        const ceiling = new THREE.Mesh(ceilingGeometry, ceilingMaterial);
        ceiling.rotation.x = Math.PI / 2;
        ceiling.position.y = 15;
        scene.add(ceiling);

        // Load wall texture and scale texture to avoid stretching
        const wallTexture = textureLoader.load('/content/49467e246fc467ba168940fb354be353afef7173dd052644ec29445647d35604i0');
        wallTexture.wrapS = wallTexture.wrapT = THREE.RepeatWrapping;
        wallTexture.repeat.set(12, 0.8);  // Adjust scaling to avoid stretched appearance

        const wallMaterial = new THREE.MeshStandardMaterial({
            map: wallTexture,
            roughness: 1.1,
            metalness: 0.1
        });
        const wallHeight = 15;
        const wallWidth = 500;
        const wallDepth = 1;

        // Create walls using wall texture
        createWall(0, wallHeight / 2, -50, wallWidth, wallHeight, wallDepth, wallMaterial);  // Back wall
        createWall(-50, wallHeight / 2, 0, wallDepth, wallHeight, wallWidth, wallMaterial);  // Left wall
        createWall(50, wallHeight / 2, 0, wallDepth, wallHeight, wallWidth, wallMaterial);   // Right wall
        createWall(0, wallHeight / 2, 50, wallWidth, wallHeight, wallDepth, wallMaterial);   // Front wall

        refreshImages();

        raycaster = new THREE.Raycaster();
        mouse = new THREE.Vector2();

        // Mouse and Keyboard Listeners
        document.addEventListener('mousedown', () => { isDragging = true; });
        document.addEventListener('mouseup', () => { isDragging = false; });
        document.addEventListener('mousemove', onMouseMove, false);
        document.addEventListener('keydown', onKeyDown, false);
        document.addEventListener('keyup', onKeyUp, false);
        document.addEventListener('click', onDocumentMouseDown, false);

        // On-screen controls for touch devices
        document.getElementById('up').addEventListener('touchstart', () => moveForward = true);
        document.getElementById('up').addEventListener('touchend', () => moveForward = false);
        document.getElementById('down').addEventListener('touchstart', () => moveBackward = true);
        document.getElementById('down').addEventListener('touchend', () => moveBackward = false);
        document.getElementById('left').addEventListener('touchstart', () => moveRight = true); 
        document.getElementById('left').addEventListener('touchend', () => moveRight = false);
        document.getElementById('right').addEventListener('touchstart', () => moveLeft = true); 
        document.getElementById('right').addEventListener('touchend', () => moveLeft = false);

        const joystick = document.getElementById('joystick');
        const joystickInner = document.getElementById('joystickInner');
        let startX, deltaX;

        joystick.addEventListener('touchstart', (e) => {
            const touch = e.touches[0];
            startX = touch.clientX;
        });

        joystick.addEventListener('touchmove', (e) => {
            e.preventDefault();
            const touch = e.touches[0];
            deltaX = touch.clientX - startX;
            const rotationSpeed = 0.0005; 
            camera.rotation.y -= deltaX * rotationSpeed;
            joystickInner.style.transform = `translateX(${deltaX}px)`;
        });

        joystick.addEventListener('touchend', () => {
            joystickInner.style.transform = `translateX(0px)`;
        });

        document.getElementById('okButton').addEventListener('click', () => {
            document.getElementById('modal').style.display = 'none';
        });

        document.getElementById('backButton').addEventListener('click', () => {
            window.history.back();
        });
        
        document.getElementById('refreshButton').addEventListener('click', (event) => {
            event.stopPropagation();  // Prevent event from propagating and triggering other handlers
            refreshImages();
        });
    }

    // Mouse Move Function
    function onMouseMove(event) {
        if (!isDragging) return;

        const movementX = event.movementX || event.mozMovementX || event.webkitMovementX || 0;
        camera.rotation.y -= movementX * 0.002;
    }

    // Keyboard Down Function
    function onKeyDown(event) {
        switch (event.code) {
            case 'ArrowDown':
            case 'KeyS':
                moveBackward = true;  
                break;
            case 'ArrowLeft':
            case 'KeyA':
                moveRight = true;  
                break;
            case 'ArrowUp':
            case 'KeyW':
                moveForward = true;  
                break;
            case 'ArrowRight':
            case 'KeyD':
                moveLeft = true;  
                break;
        }
    }

    // Keyboard Up Function
    function onKeyUp(event) {
        switch (event.code) {
            case 'ArrowDown':
            case 'KeyS':
                moveBackward = false;  
                break;
            case 'ArrowLeft':
            case 'KeyA':
                moveRight = false;  
                break;
            case 'ArrowUp':
            case 'KeyW':
                moveForward = false;  
                break;
            case 'ArrowRight':
            case 'KeyD':
                moveLeft = false;  
                break;
        }
    }

    // Mouse Click Function
    function onDocumentMouseDown(event) {
        event.preventDefault();

        mouse.x = (event.clientX / window.innerWidth) * 2 - 1;
        mouse.y = -(event.clientY / window.innerHeight) * 2 + 1;

        raycaster.setFromCamera(mouse, camera);

        const intersects = raycaster.intersectObjects(scene.children, true);

        if (intersects.length > 0) {
            const object = intersects[0].object;
            if (object.userData.url) {
                window.open(object.userData.url, '_blank');
            }
        }
    }

    function createWall(x, y, z, width, height, depth, material) {
        const wallGeometry = new THREE.BoxGeometry(width, height, depth);
        const wall = new THREE.Mesh(wallGeometry, material);
        wall.position.set(x, y, z);
        scene.add(wall);
        return wall;
    }

    function refreshImages() {
        // Remove existing image meshes
        for (let mesh of imageMeshes) {
            scene.remove(mesh);
        }
        imageMeshes = [];

        const imageSize = 6;
        const imageDistance = 10;
        let index = currentImageIndex;

        const firstRowHeight = 4;
        const secondRowHeight = 11;

        // Back wall
        for (let i = -40; i <= 40; i += imageDistance) {
            if (index >= inscriptionIds.length) index = 0;
            createImageOnWall(i, firstRowHeight, -49 + 0.1, 0, index++);  // First row
            if (index >= inscriptionIds.length) index = 0;
            createImageOnWall(i, secondRowHeight, -49 + 0.1, 0, index++);  // Second row
        }

        // Left wall
        for (let i = -40; i <= 40; i += imageDistance) {
            if (index >= inscriptionIds.length) index = 0;
            createImageOnWall(-49 + 0.1, firstRowHeight, i, Math.PI / 2, index++);  // First row
            if (index >= inscriptionIds.length) index = 0;
            createImageOnWall(-49 + 0.1, secondRowHeight, i, Math.PI / 2, index++);  // Second row
        }

        // Front wall
        for (let i = -40; i <= 40; i += imageDistance) {
            if (index >= inscriptionIds.length) index = 0;
            createImageOnWall(i, firstRowHeight, 49 - 0.1, Math.PI, index++);  // First row
            if (index >= inscriptionIds.length) index = 0;
            createImageOnWall(i, secondRowHeight, 49 - 0.1, Math.PI, index++);  // Second row
        }

        // Right wall
        for (let i = -40; i <= 40; i += imageDistance) {
            if (index >= inscriptionIds.length) index = 0;
            createImageOnWall(49 - 0.1, firstRowHeight, i, -Math.PI / 2, index++);  // First row
            if (index >= inscriptionIds.length) index = 0;
            createImageOnWall(49 - 0.1, secondRowHeight, i, -Math.PI / 2, index++);  // Second row
        }

        currentImageIndex = index % inscriptionIds.length;
    }


    function createImageOnWall(x, y, z, rotY, index) {
        if (index >= inscriptionIds.length) return;

        const textureLoader = new THREE.TextureLoader();
        const texture = textureLoader.load(`/content/${inscriptionIds[index]}`);
        const imageMaterial = new THREE.MeshBasicMaterial({ map: texture });
        const imageGeometry = new THREE.PlaneGeometry(6, 6);
        const imageMesh = new THREE.Mesh(imageGeometry, imageMaterial);

        imageMesh.position.set(x, y, z);
        imageMesh.rotation.y = rotY;
        imageMesh.userData = { url: `https://doggy.market/inscription/${inscriptionIds[index]}` };
        scene.add(imageMesh);
        imageMeshes.push(imageMesh);
    }
    
    // Animation loop
    function animate() {
        requestAnimationFrame(animate);

        let moveDirection = new THREE.Vector3();

        if (moveForward) {
            moveDirection.add(camera.getWorldDirection(new THREE.Vector3()).multiplyScalar(speed));
        }
        if (moveBackward) {
            moveDirection.sub(camera.getWorldDirection(new THREE.Vector3()).multiplyScalar(speed));
        }
        if (moveLeft) {
            moveDirection.x -= camera.getWorldDirection(new THREE.Vector3()).z * speed;
            moveDirection.z += camera.getWorldDirection(new THREE.Vector3()).x * speed;
        }
        if (moveRight) {
            moveDirection.x += camera.getWorldDirection(new THREE.Vector3()).z * speed;
            moveDirection.z -= camera.getWorldDirection(new THREE.Vector3()).x * speed;
        }

        camera.position.add(moveDirection);

        const floorLevel = 0;
        const ceilingHeight = 15;
        const wallLimit = 245;  // Adjust this value based on the size of your walls
        camera.position.y = Math.max(floorLevel + 1.7, Math.min(ceilingHeight - 0.5, camera.position.y));
        camera.position.x = Math.max(-49, Math.min(49, camera.position.x));
        camera.position.z = Math.max(-49, Math.min(49, camera.position.z));

        renderer.render(scene, camera);
    }

    window.addEventListener('resize', function () {
        camera.aspect = window.innerWidth / window.innerHeight;
        camera.updateProjectionMatrix();
        renderer.setSize(window.innerWidth, window.innerHeight);
    }, false);
</script>

</body>
</html>
